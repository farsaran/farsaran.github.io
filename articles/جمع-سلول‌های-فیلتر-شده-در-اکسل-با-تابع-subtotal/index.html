<!doctype html><html lang="fa" dir="rtl"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="geo.region" content="IRAN"><link rel="canonical" href="https://hejazee.ir/articles/%D8%AC%D9%85%D8%B9-%D8%B3%D9%84%D9%88%D9%84%E2%80%8C%D9%87%D8%A7%DB%8C-%D9%81%DB%8C%D9%84%D8%AA%D8%B1-%D8%B4%D8%AF%D9%87-%D8%AF%D8%B1-%D8%A7%DA%A9%D8%B3%D9%84-%D8%A8%D8%A7-%D8%AA%D8%A7%D8%A8%D8%B9-subtotal/"><link rel="shortcut icon" href="/favicon.png" type="image/png"><title>جمع سلول‌های فیلتر شده در اکسل با تابع SUBTOTAL | فرساران</title><link rel="stylesheet" href="/lib/bootstrap-5.1.3-dist/css/bootstrap.rtl.min.css"><link rel="stylesheet" href="/lib/fontawesome-free-5.15.2-web/css/all.min.css"><link rel="stylesheet" href="/fonts/fonts.css"><link rel="stylesheet" href="/scss/index.eeaf9b5cdc8ca0516d79cf83719363b8d9d044b15ec221f8f8895348d28d009b.css" integrity="sha256-7q+bXNyMoFFtec+DcZNjuNnQRLFewiH4+IlTSNKNAJs=" crossorigin="anonymous"></head><body><nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="farsaran-header-nav"><div class="container"><a class="navbar-brand order-0 flex-grow-1 flex-lg-grow-0" href="/"><img src="/logo.png" alt="فرساران" height="34"></a>
<button class="navbar-toggler order-2 order-lg-1" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="نمایش منو">
<span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse mb-3 mb-lg-0" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"><a class="nav-link" href="/excel/">دوره آموزش اکسل</a></li><li class="nav-item"><a class="nav-link" href="/products/">محصولات</a></li><li class="nav-item"><a class="nav-link" href="/articles/">مقالات آموزشی اکسل</a></li><li class="nav-item"><a class="nav-link" href="https://www.instagram.com/farsaran_excel/">اینستاگرام فرساران</a></li><li class="nav-item"><a class="nav-link" href="/contact/">تماس با ما</a></li></ul><form role="search" action="/search/node" id="navbar-search-form"><input type="search" name="keys" placeholder="جستجو" aria-label="جستجو" class="search-query">
<button type="submit">
<i class="fa fa-search"></i></button></form></div><div id="navbar-accessories" class="d-flex order-1 order-lg-2 mx-3 mx-lg-0"><a href="/contact" class="contact-link"><i class="fa fa-phone"></i></a></div></div></nav><div class="container"><div class="row"><div class="col-12"><header><h1 class="post-title fw-bold fs-2"><a class="text-dark" href="/articles/%D8%AC%D9%85%D8%B9-%D8%B3%D9%84%D9%88%D9%84%E2%80%8C%D9%87%D8%A7%DB%8C-%D9%81%DB%8C%D9%84%D8%AA%D8%B1-%D8%B4%D8%AF%D9%87-%D8%AF%D8%B1-%D8%A7%DA%A9%D8%B3%D9%84-%D8%A8%D8%A7-%D8%AA%D8%A7%D8%A8%D8%B9-subtotal/">جمع سلول‌های فیلتر شده در اکسل با تابع SUBTOTAL</a></h1></header><article class="blog-post" role="article" typeof="schema:Article"><p>معمولا دیده‌اید که در زیر (انتهای) جداول یک سطر جمع مانند تصویر زیر وجود دارد و به سادگی اینکار با تابع SUM انجام می‌شود:</p><p><img alt="تابع SUM در اکسل" height="350" src="https://www.farsaran.com/sites/default/files/field/image/subtotal_sum.jpg" width="554"></p><p>بگذارید قبل از ادامه، چند سوال احتمالی شما را پاسخ بگویم:</p><p>1) چرا بین جدول و سطر جمع، یک سطر خالی وجود دارد؟</p><p>پاسخ: به دلیل آنکه این سطر جدا از جدول باشد. در غیر اینصورت در هنگام SORT کردن و یا FILTER این سطر جزئی از جدول فرض می‌شود و SORT و یا FILTER خواهد شد. به شما هم توصیه می‌کنم که همیشه اینکار را انجام دهید.</p><p>2) آیا می‌توانم به جای نوشتن D3:D8 بنویسم D:D که کل ستون را شامل شود؟</p><p>پاسخ: خیــــــــــــــــــــــر!!!! مبادا اینکار را کنید. نباید فرمول در داخل منطقه‌ای باشد که روی آن محاسبه‌ای را انجام می‌دهد. اگر اینکار را کنید، نتیجه این فرمول عدد 0 می‌شود و خطای Circular Reference را خواهید دید.</p><p>حال بیایید این جدول را بر اساس ستون نوع «فیلتر» کنیم و ببیند که آیا نتیجه تابع SUM تغییر می‌کند یا نه ؟</p><p><img alt="تفاوت SUM و SUBTOTAL" height="210" src="https://www.farsaran.com/sites/default/files/field/image/subtotal_sum_2.jpg" width="840"></p><p>می‌بینیم که نتیجه تابع SUM تغییر نکرد، اگر اینکار را با سایر توابع اکسل مانند AVERAGE, COUNT, SUMIFS, VLOOKUP و ... انجام دهید، خواهید دید که این توابع هیچ واکنشی به فیلتر بودن و یا نبودن جدول ما نشان نمی‌دهند، بنابراین این نتیجه را می‌گیریم:</p><div class="farsaran-info"><span style="font-size:24px">نتیجه: تابع SUM و هیچ تابع دیگری در اکسل به فلیتر حساس نیست بجز ؟؟؟</span></div><h2>معرفی SUBTOTAL در اکسل</h2><p>کاملا واضح است که گاهی نیاز داریم که «حاصل جزئی» از داده‌هایی را محاسبه کنیم و نه همه داده‌ها و اینجاست که باید تابع SUBTOTAL اکسل را به شما معرفی کنم. در همین ابتدا باید بدانید که:</p><div class="farsaran-warning"><span style="font-size:24px">ویژگی اصلی SUBTOTAL آن است که به فیلتر حساس است.</span></div><p>یعنی SUBTOTAL فقط بر روی داده‌هایی محاسبه انجام می‌دهد که دیده می‌شوند و آنچه را که دیده نمی‌شوند را در محاسبه منظور نمی‌کند.</p><p>اما بگذارید نگاهی بیندازیم به معنی کلمه SUBTOTAL!! زیرا بیشتر افراد تصور می‌کنند که SUBTOTAL جمع می‌زند و کلمه TOTAL را «جمع» ترجمه می‌کنند. این تصور غلطی است. اگر ما TOTAL را به کلمه «حاصل» ترجمه کنیم، و SUB را به «جزء»، آنگاه ترجمه دقیق‌تری از SUBTOTAL خواهیم داشت. یعنی «محاسبه جزئی» از داده‌ها و نه همه داده‌ها.</p><p>در واقع من بحث ترجمه SUBTOTAL با این منظور در میان آوردم تا به شما بگویم تا به اشتباه تصور نکنید که قرار است «فقط» با این تابع «جمع» داده‌ها را محاسبه کنیم. بلکه:</p><div class="farsaran-danger"><span style="font-size:24px">تابع SUBTOTAL برای ما 11 محاسبه مختلف را انجام می‌دهد.<br>مانند چاقوی ارتش سوئیس !</span></div><p><img alt="چاقوی ارتش سوئیس" height="200" src="https://www.farsaran.com/sites/default/files/field/image/Swiss%20Army%20knife.JPG" width="346"></p><p>بله! دقیقا 11 محاسبه مختلف با یک تابع که بر روی «جزئی» از داده‌ها انجام خواهد شد.</p><p>یعنی اگر شما خواستید AVERAGE (میانگین) سلول‌های فیلتر شده را محاسبه کنید، همچنان باید از SUBTOTAL استفاده کنید که در ادامه توضیح می‌دهم.</p><h3>نوشتن فرمول SUBTOTAL</h3><p>هنگامی که SUBTOTAL را در اکسل می‌نویسید و علامت پرانتز را باز می‌کنید به صورت خودکار (اتوماتیک ) اکسل لیستی از تمامی 11 کاری که SUBTOTAL انجام می‌دهد را برای شما نمایش می‌دهد:</p><p><img alt="لیستی از کارهایی که SUBTOTAL انجام می دهد" height="290" src="https://www.farsaran.com/sites/default/files/field/image/SUBTOTAL_LIST.jpg" width="619"></p><p>بیایید نگاهی دقیق به این لیست بیندازیم:</p><p>الف) قبل از هر تابعی یک عدد نوشته شده است که به آن «کد تابع در SUBTOTAL» می‌گوییم.</p><p>ب) اگر لیست را دقیق تر نگاه کنید، می‌بینید که هر تابعی 2 بار تکرار شده است !</p><p><img alt="کدهای تابع SUBTOTAL" height="320" src="https://www.farsaran.com/sites/default/files/field/image/SUBTOTAL_CODE.jpg" width="629"></p><p>اجازه بدهید فعلا تفاوت این کدها را نگویم و فرض کنید که هر 2 یکسان عمل می‌کنند. (زیرا واقعا و در عمل مهم نیست)</p><p>نکته) اگر این لیست را ندید، یکبار علامت پرانتزی که باز کرده‌اید را پاک کنید و مجدد آن را تایپ کنید.</p><p>بنابراین اولین کاری که در نوشتن SUBTOTAL در اکسل انجام می‌دهد، این است که باید به تابع بگویید که باید برای شما چه محاسبه‌ای را انجام دهد و اینکار را با نوشتن این کدها باید انجام دهید. یعنی اگر خواستید که تابع SUBTOTAL برای شما سلول‌های فیلتر شده را «جمع» بزند، باید بنویسید:</p><p dir="ltr">=SUBTOTAL(<span style="color:#b22222">9</span><br>یا<br>=SUBTOTAL(<span style="color:#b22222">109</span></p><p>و این فرمول را در ذهنتان اینگونه باید بخوانید: «ساب توتال جمع بزن ... »</p><p>و اگر خواستید که این تابع برای شما میانگین فیلتر شده‌ها را محاسبه کند، باید بنویسید:</p><p dir="ltr">=SUBTOTAL(<span style="color:#b22222">1</span><br>یا<br>=SUBTOTAL(<span style="color:#b22222">101</span></p><p>و این فرمول را در ذهنتان اینگونه باید بخوانید: «ساب توتال میانگین بگیر ... »</p><p>سوال) آیا باید کدها را حفظ کنم؟</p><p>پاسخ: خیر. زیرا همیشه هنگام نوشتن SUBTOTAL آن ها را می‌توانید ببیند و اگر روی هر تابعی که در لیست نمایش شده دبل کلیک کنید، خود اکسل برای شما کدش را خواهد نوشت.</p><p>سوال) آیا می‌توانم به جای نوشتن کد تابع، نام تابع را بنویسم؟</p><p>پاسخ: خیر. اولین ورودی تابع SUBTOTAL یک عدد است.</p><p>سوال) فرق بین کد 9 و 109 چیست؟</p><p>پاسخ: تا انتهای همین مقاله را بخوانید و فعلا مهم نیست.</p><p>حال باید مشخص کنید که تابع SUBTOTAL باید بر روی چه سلول‌هایی محاسبه را انجام دهد و آدرس این سلول‌ها را به عنوان ورودی بعدی تابع SUBTOTAL خواهیم نوشت.</p><p dir="ltr">=SUBTOTAL(109, <span style="color:#b22222">D3:D8</span>)</p><p>نکته: اگر تنظیمات Control Panel --> Region شما بر روی فارسی باشد، باید به جای علامت کاما در فرمول بالا، علامت سمی کالن یعنی «;» را بنویسید.</p><p>و اگر هم اکنون سلول‌ها را فیلتر کنید، خواهید دید که SUBTOTAL برای شما فقط جمع سلول‌های که دیده می‌شوند را محاسبه می‌کند:</p><p><img alt="تابع ساب توتال" height="224" src="https://www.farsaran.com/sites/default/files/field/image/SUBTOTAL_FORMULA.jpg" width="840"></p><h3>تفاوت کد 9 و 109 در جمع زدن چیست؟</h3><p>اگر مجدد به لیست توابع SUBTOTAL نگاهی بیندازید، خواهید دید که کدها دو دسته هستند. یکی بین عدد 1 تا 11 و دیگری بین عدد 101 تا 111.</p><p>کدهای سه رقمی (یعنی بین 101 تا 111) هم به «فیلتر حساس هستند» و همچنین به «سلولهای Hide شده» ! اما کدهای بین 1 تا 11 فقط و فقط به «فیلتر حساس» هستند.&nbsp;</p><p>دقت کنید که در اکسل می‌توانیم سطرها را Hide (مخفی) کنیم و اگر خواستیم فرمولی بنویسیم که فقط آنچه نمایش داده می‌شود را محاسبه کند (یعنی هر چیزی که فیلتر شده است یا Hide شده است، را نادیده بگیرد) از کدهای سه رقمی استفاده می‌کنیم. اما اگر خواستم که برای تابع ساب توتال،&nbsp; Hide بودن و یا نبودن سلول‌ها فرقی نکند و فقط به فیلتر شده‌ها حساس باشد، از کدهای بین 1 تا 11 استفاده می‌کنیم.</p><p>توجه داشته باشید که کسی&nbsp; در اکسل و داده‌های بزرگ، سطرها را Hide نمی‌کنیم و به همین دلیل در گفتم که آنچنان مهم نیست و معمولا همه از کد 109 استفاده می‌کنند.</p><h3>شماره ردیف اتوماتیک بعد از فیلتر شدن</h3><p>یکی از کاربردهای بسیار مشهور تابع SUBTOTAL برای «شماره گذاری اتوماتیک سطرها (ردیف‌ها) بعد از فیلتر کردن است» و معمولا کاربران اکسل می‌پرسند "چطور می‌توانم شماره‌ ردیف (سطرها) منظمی بعد از فیلتر کردن داده‌ها داشته باشم؟".</p><p>مثلا در تصویر زیر می‌بینید که ما چیزهایی که 0 پا دارند را فیلتر کرده‌ایم و شماره ردیف‌ها در اکسل نامنظم شده است.</p><p><img alt="شماره ردیف بعد از فیلتر" height="287" src="https://www.farsaran.com/sites/default/files/field/image/SUBTOTAL_ROWNUMBER_1.jpg" width="550"></p><p>ما تا اینجا می‌دانیم که تنها تابعی در اکسل که به فیلتر شدن سطرها حساس است، SUBTOTAL است و در نتیجه باید این مساله را با SUBTOTAL حل کرد.</p><p>من قبل از هرچیز باید بگویم که توضیح دقیق این فرمول به صورت نوشتاری کمی سخت است و امیداورم که در توضیحش موفق شوم. به تصویر زیر دقت کنید:</p><p><img alt="شماره ردیف بعد از فیلتر" height="316" src="https://www.farsaran.com/sites/default/files/field/image/SUBTOTAL_ROWNUMBER_2.jpg" width="698"></p><p>برای ساده‌تر درک فرمولی که قرار است بنویسیم، یکی از سلول‌های وسط لیست مانند سلول A6 که زرد شده است را در نظر بگیرید. اگر از شما بپرسم که به عنوان شماره ردیف چه عددی باید در این سلول نوشته شود، چه پاسخی می‌دهید؟</p><p>لطفا لحظه‌ای تمرکز کنید. پاسخ دقیق آن است که بگویید:</p><div class="farsaran-danger"><span style="font-size:18px">این عدد برابر است با تعداد سلول‌های پـُری که از ابتدای ستون «نوع» (یعنی B3) تا سلول زرد می‌توانم ببینم.</span></div><p>حال همین فرمول را می‌نویسیم.</p><p>1) چون گفته‌اید «می‌توانم ببینم» (چون شاید برخی Filter شده باشند) ،بنابراین از SUBTOTAL استفاده می‌کنیم:</p><p dir="ltr">=<span style="color:#b22222">SUBTOTAL(</span></p><p>2) چون گفتید «سلول‌های پُر»، بنابراین باید از کد تابع COUNTA استفاده کنیم یعنی عدد 103 :</p><p dir="ltr">=SUBTOTAL(<span style="color:#b22222">103</span>,</p><p>3) گفتید «از ابتدای ستون نوع»، بنابراین باید به سلول B3 اشاره کنیم و چون قرار است که این فرمول را برای سایر سطرها بعدا کپی کنیم، باید این آدرس را به صورت مطلق با علامت $ بنویسیم:</p><p dir="ltr">=SUBTOTAL(103, <span style="color:#b22222">$B$3</span></p><p>4) چون گفتید «تا»، باید از علامت «:» استفاده کنید:</p><p dir="ltr">=SUBTOTAL(103, $B$3<span style="color:#b22222">:</span></p><p>5) چون گفتید «سلول زرد رنگ» و سلول زرد رنگ در سطر 6 قرار داد و از قبل هم شمارشتان بر اساس ستون B بود، پس می نویسیم:</p><p dir="ltr">=SUBTOTAL(103, $B$3:<span style="color:#b22222">B6)</span></p><p>6) این فرمول را برای همه سلولها کپی کنید، تا&nbsp; شماره ردیف‌ها همواره به صورت صحیح نمایش داده شوند:</p><p><img alt="شماره ردیف بعد از فیلتر" height="229" src="https://www.farsaran.com/sites/default/files/field/image/SUBTOTAL_ROWNUMBER_3.jpg" width="616"></p><p>پاسخ به سوال‌های احتمالی شما:</p><p>سوال 1) چرا ستون «نوع» را شمارش کرده‌ایم؟</p><p>پاسخ: برای شماره سطر ما باید چیزی را بشماریم و چون در این لیست همواره همه‌ی ستون «نوع» پر است، بنابراین این ستون را شمارش کردیم، البته در این مثال می‌توانیم ستون «اسم» را هم شمارش کنیم.</p><p>سوال 2) تفاوت تابع COUNT و COUNTA چیست؟</p><p>پاسخ: تابعCOUNT تعداد سلول‌های «عددی» را شمارش می‌کند در حالی که تابع COUNTA سلول‌های «پر» را شمارش می‌کند.</p><p>سوال 3) آیا در فرمول قبلی باید قبل از B حتما باید علامت $ باشد؟</p><p>پاسخ: خیر! چون این فرمول فقط در جهت عمودی (سطرها) کپی می‌شود، کافی است که قبل از عدد 3 یک $ بگذاریم.</p><p>سوال 4) علامت $ در فرمول چیست؟</p><p>پاسخ: ما در اکسل مفهوم بسیار مهمی به نام آدرس مطلق و آدرس نسبی داریم. اگر این مفهوم را نمی‌دانید به شما توصیه می‌کنم که حتما آن را یاد بگیرید.</p><h3>Nested Subtotal چیه؟</h3><p>اگر در Help تابع SUBTOTAL در اکسل مراجعه کنید، این متن را خواهید دید:</p><p><img alt="مفهوم Nested Subtal چیست" height="77" src="https://www.farsaran.com/sites/default/files/field/image/NESTE_SUBTOTAL.jpg" width="840"></p><p>در این متن نوشته شده است، که تابع SUBTOTAL در هنگام محاسبه Nested Subtotalها را نادیده می‌گیرد. اجازه دهید توضیح دقیقی بدهم. تا اینجا یادگرفتیم که تابع SUBTOTAL به «فیلتر» حساس است و همچنین می‌تواند به «Hide» ها هم حساس باشد و اکنون می‌خواهم بگویم که SUBTOTAL «به خودش هم حساس است» <img alt="surprise" height="23" src="//cdn.ckeditor.com/4.5.4/full-all/plugins/smiley/images/omg_smile.png" title="surprise" width="23">.</p><p>یعنی تابع SUBTOTAL هنگام محاسبه، سایر SUBTOTALهایی که در داخل محدوده‌اش وجود (که اصطلاحا Nested Subtotal می‌گویند) دارند را نادیده می‌گیرد. به تصویر زیر دقت کنید:</p><p><img alt="محاسبه جمع تو در تو با subtotal" height="398" src="https://www.farsaran.com/sites/default/files/field/image/NESTE_SUBTOTAL_1.jpg" width="840"></p><p>تابعی که در سلول D10 نوشته شده است، مقادیر دو سلول زرد رنگ را نادیده می‌گیرد. در غیر اینصورت جمع D3:D11 باید عدد 24 (یعنی دو برابر) می‌شد.</p><p>تذکر مهم: توصیه نمی‌کنم که از این روش برای ساخت گزارش‌ها استفاده کنید زیرا احتمال اشتباهات سهوی بسیار بالا است.</p><h3>معرفی تابع AGGREGATE ، نسل جدید SUBTOTAL</h3><p>AGGREGATE تابعی است که از نسخه 2010 به اکسل اضافه شد و علاوه بر تمامی ویژگی‌های SUBTOTAL دارای چندین قابلیت جدید است.</p><div class="farsaran-warning"><span style="font-size:24px">مهمترین قابلیت AGGREAGE نادیده گرفتن خطاهای در محاسبه است.</span></div><p>شاید بدانید که هر محاسبه‌ای روی مقادیر خطا مانند VALUE# و NAME# و ... انجام شود، نتیجه‌اش قابل محاسبه نیست و خطا خواهد شد. اما با تابع AGGREAGE می‌توانیم روی سلول‌هایی که ممکن است برخی از آنها خطایی داشته باشند، محاسباتی را انجام دهیم. همچنین باید بدانید که با AGGREAGE می‌توانیم 19محاسبه مختلف را انجام دهیم (درSUBTOTAL ما 11 تابع داشتیم) . که در تصویر زیر می‌توانید آنها را ببیند.</p><p><img alt="تابع AGGREGATE در اکسل " height="389" src="https://www.farsaran.com/sites/default/files/field/image/AGGREGATE.jpg" width="406"></p><p>اجازه دهید که شکل کلی تابع AGGREGATE را بررسی کنیم:</p><p dir="ltr"><img alt="ورودیهای تابع AGGREGATE" height="147" src="https://www.farsaran.com/sites/default/files/field/image/AGGREGATE_ARGUMENTS.jpg" width="723"></p><p>ورودی 1) کد تابع را وارد کنید: دقیقا مانند SUBTOTAL باید اول مشخص کنیم که قرار است AGGREAGE چه کاری را انجام دهد و باید «کد» تابع مورد نظر را اینجا بنویسیم.</p><p>ورودی 2) باید به تابع AGGREGATE بگوییم که باید چه چیزهایی را نادیده بگیرد و چه چیزهایی را محاسبه کند. در اینجا هم باید یک «کد» را وارد کنیم. این کدها در جدول زیر شرح داده شده است.</p><table align="right" dir="rtl" height="269" style="width:100%" width="768"><tbody><tr><th style="width:213px">کد</th><th style="width:1500px">رفتار aggreage</th></tr><tr><td style="width:213px">0 یا هیچی</td><td style="width:1500px"><p>نادیده گرفتن SUBTOTAL و AGGREGATEهایی که Nested هستند.</p></td></tr><tr><td style="width:213px">1</td><td style="width:1500px"><p>نادیده گرفتن سطرهای Hide شده و SUBTOTAL و AGGREGATEهایی که Nested هستند.</p></td></tr><tr><td style="width:213px">2</td><td style="width:1500px"><p>نادیده گرفتن مقادیر خطا و SUBTOTAL و AGGREGATEهایی که Nested هستند.</p></td></tr><tr><td style="width:213px">3</td><td style="width:1500px"><p>نادیده گرفتن سطرهای Hide شده و مقادیر خطا و SUBTOTAL و AGGREGATEهایی که Nested هستند.</p></td></tr><tr><td style="width:213px">4</td><td style="width:1500px"><p>هیچ چیزی را نادیده نگیر</p></td></tr><tr><td style="width:213px">5</td><td style="width:1500px"><p>فقط سطرهای Hide را نادیده بگیر</p></td></tr><tr><td style="width:213px">6</td><td style="width:1500px"><p>فقط مقادیر خطا را نادیده بگیر</p></td></tr><tr><td style="width:213px">7</td><td style="width:1500px"><p>سطرهای Hide و همچنین مقادیر خطا را نادیده بگیر</p></td></tr></tbody></table><p>نکته: منظور از Hide یعنی سطرهایی که در اثر Hide کردن و یا Filter کردن دیده نمی‌شوند.</p><p>ورودی 3) باید بگوییم که کجا داده‌های ما هستند تا تابع بر روی آنها محاسبه‌ای را انجام دهد.</p><p>به فرمول سلول سبز رنگ در مثال زیر دقت کنید:</p><p><img alt="مثال تابع aggregate در اکسل" height="388" src="https://www.farsaran.com/sites/default/files/field/image/AGGREGATE_SAMPLE.jpg" width="840"></p><div class="farsaran-info">در فرمول سلول سبز رنگ، عدد 9 یعنی AGGREGATE باید «جمع» داده‌ها را محاسبه کند و عدد 3 یعنی اینکه:<br>* سلول‌های Hide شده را نادیده بگیرد. منظور از Hide ها همان سلولهایی است که دیده نمی‌شوند. بنابراین تعداد پاهای عقاب&nbsp; که در سلول D4 است، در جمع محاسبه نمی‌شود.<br>* مقادیر خطا یعنی سلولهای D7 , D8 را نادیده بگیرد.<br>* Nested Subtotal ها را نادیده بگیرد، یعنی سلول D6 و همچنین Nested Aggreage را نادیده بگیرد یعنی سلول D10 که در این مثال زرد رنگ شده اند.</div><p>سایر نکته‌های:</p><p>1) تابع SUBTOTAL و AGGREGATE برای کار بر روی سطرها طراحی شده‌اند و مخفی کردن ستون‌ها در نتیجه‌ آنها تاثیری ندارد.</p><p>2) اگر ابتدا داده‌ها را فیلتر کنید و سپس در زیر یکی از ستون‌های عددی کلید = + ALT (کلید ALT و مساوی) را بزنید، خواهید دید که به جای تابع SUM ، برای شما SUBTOTAL می‌نویسید.</p><p>3) اگر داده‌های شما Table است، لازم نیست که SUBTOTAL را بنویسید، گزینه TOTAL ROW را فعال کنید و سپس کافی است که در آخرین سطر TABLE هر تابعی را که می‌خواهید را انتخاب کنید.</p><p><img alt="سطر جمع در TABLE " height="619" src="https://www.farsaran.com/sites/default/files/field/image/SUBTOTAL_TABLE.jpg" width="663"></p><div class="farsaran-info">نکته پایانی:&nbsp;<br>معمولا در <a href="/excel">دوره‌های آموزش اکسل</a> فرساران از فراگیران می‌پرسم که ترجمه SUBTOTAL چیست و هر کسی چیزی می‌گوید و این را بهانه‌ای می‌کنم تا&nbsp;رمان ارزشمند&nbsp;«<strong>جزء از کل</strong>» (ترجمه پیمان خاکسار) را معرفی کنم. بله، بهترین ترجمه برای SUBTOTAL، «جزء از کل» است.</div><p>&nbsp;</p><p>خوش باشید / فرشید میدانی</p><footer><h4>همچنین بخوانید</h4><ul><li><a href="/articles/%D8%A2%D9%85%D9%88%D8%B2%D8%B4-%D8%B1%D9%88%D8%B4-%D8%A7%D8%B3%D8%AA%D8%A7%D9%86%D8%AF%D8%A7%D8%B1%D8%AF-%D8%AA%D8%A7%DB%8C%D9%BE-%D9%88-%D9%86%D9%88%D8%B4%D8%AA%D9%86-%D8%A7%D8%B9%D8%AF%D8%A7%D8%AF-%D9%81%D8%A7%D8%B1%D8%B3%DB%8C-%D8%AF%D8%B1-%D8%A7%DA%A9%D8%B3%D9%84/">آموزش روش استاندارد تایپ و نوشتن اعداد فارسی در اکسل</a></li><li><a href="/articles/%D8%A7%D8%AF%D8%BA%D8%A7%D9%85-%D9%81%D8%A7%DB%8C%D9%84-%D9%87%D8%A7-%D9%88-%D8%B4%DB%8C%D8%AA-%D9%87%D8%A7-%D8%AF%D8%B1-%D8%A7%DA%A9%D8%B3%D9%84/">ادغام فایل ها و شیت ها در اکسل</a></li><li><a href="/articles/%D8%AA%D8%B1%D9%81%D9%86%D8%AF-%D8%AF%D8%B1%D8%AC-%D8%B9%DA%A9%D8%B3-%D8%AF%D8%B1-%D8%B3%D9%84%D9%88%D9%84%E2%80%8C%D9%87%D8%A7%DB%8C-%D8%A7%DA%A9%D8%B3%D9%84-%D8%A8%D8%A7-%D8%A7%D8%B3%D8%AA%D9%81%D8%A7%D8%AF%D9%87-%D8%A7%D8%B2-%D8%AA%D9%86%D8%B8%DB%8C%D9%85%D8%A7%D8%AA-comment/">ترفند درج عکس در سلول‌های اکسل با استفاده از تنظیمات Comment</a></li><li><a href="/articles/%D8%B3%D8%A7%D8%AE%D8%AA-combo-box-%DA%A9%D9%85%D8%A8%D9%88-%D8%A8%D8%A7%DA%A9%D8%B3-%D8%A8%D8%A7-%D9%85%D9%82%D8%A7%D8%AF%DB%8C%D8%B1-%D9%85%D8%AA%D8%BA%DB%8C%D8%B1-%D8%AF%D8%B1-%D8%A7%DA%A9%D8%B3%D9%84/">ساخت Combo box (کمبو باکس) با مقادیر متغیر در اکسل</a></li><li><a href="/articles/%D9%85%D8%AD%D8%A7%D8%B3%D8%A8%D9%87-%D8%AD%D9%82%D9%88%D9%82-%D9%88-%D8%AF%D8%B3%D8%AA%D9%85%D8%B2%D8%AF-%D8%AF%D8%B1-%D8%A7%DA%A9%D8%B3%D9%84/">محاسبه حقوق و دستمزد در اکسل</a></li></ul></footer></article></div></div></div><footer id="footer-wrapper"><div id="footer-cols-wrapper"><div class="container"><div class="row"><div class="col-md-6 col-lg-3"><p>⭐⭐⭐ دوره‌های آنلاین آموزش اکسل ۱۴۰۱</p><p>استاد دوره: فرشید میدانی</p><p><a href="/excel">دوره آموزش آنلاین اکسل از کاربردی تا پیشرفته</a></p><p><a href="/excel">دوره آموزش آنلاین طراحی داشبورد و نمودارهای خلاقانه در اکسل</a></p><p><a href="/excel">دوره آموزش آنلاین زبان برنامه نویسی VBA در اکسل</a></p></div><div class="col-md-6 col-lg-3"><h5 class="fs-6 fw-bold">محصولات و مقالات</h5><p><a href="/node/106" target="_blank">تاریخ شمسی اکسل و عدد به حروف</a></p><p><a href="/taxonomy/term/126">آموزش اکسل پیشرفته</a></p><p><a href="/node/252" target="_blank">کتاب توابع و فرمول نویسی اکسل</a></p><p><a href="/node/257" target="_blank">کتاب برنامه نویسی VBA اکسل</a></p><p><a href="/pivot" target="_blank">دوره آموزش پیوت تیبل&nbsp;اکسل</a></p></div><div class="col-md-6 col-lg-3"><p><a href="/contact">تماس با ما</a></p><p><a href="/فرشید-میدانی">مشاهده رزومه فرشید میدانی&nbsp;</a></p><p><a href="/node/114">راهنمای خرید از فروشگاه</a></p><p><a href="/node/114#guaranty">شرایط گارانتی و پشتیبانی محصولات</a></p><p><a href="/node/114#guaranty">درخواست عودت وجه محصولات</a></p><p><a href="http://t.me/farsaran" rel="nofollow">کانال تلگرام اکسل فرساران</a></p></div><div class="col-md-6 col-lg-3"><p>مقالات آموزشی اکسل</p><p>⭐&nbsp;<a href="/farfand">فرفند، کاربردی ترین ترفند اکسل</a></p><p><a href="/node/294">محاسبه مالیات حقوق در اکسل</a></p><p><a href="/vlookup">آموزش تابع VLOOKUP در اکسل</a></p><p><a href="/sumifs">آموزش تابع SUMIFS در اکسل</a></p></div></div></div></div><div id="footer-bottom-wrapper"><div class="container"><div class="row"><div class="col-12"><p><span style="font-size:16px">&nbsp;فرساران | تجربه حرفه‌ای و تمام وقت<a href="/node/313"><span style="color:#fff"> <u>آموزش اکسل</u></span></a><span style="color:#fff"> </span>از سال ۱۳۸۵ در صدها شرکت و سازمان تراز اول ایران</span></p><p><strong><u><a href="https://fa.wikipedia.org/wiki/%D8%AF%D8%B3%D8%AA%D8%A8%D8%B1%D8%AF_%D9%81%DA%A9%D8%B1%DB%8C" target="_blank"><span style="color:#fff">دستبرد علمی</span></a></u></strong><span style="color:#fff"> </span>یعنی تخصیص دادن خلاقیت ادبی، هنری یا پژوهشی دیگری یا بخشی از آن یا متن ناشی از آن به خود، گویی که خود شخص آن را خلق کرده‌است.&nbsp;</p></div></div></div></div></footer><script src="/lib/jQuery/jquery-3.6.0.min.js"></script>
<script src="/lib/bootstrap-5.1.3-dist/js/bootstrap.bundle.min.js"></script></body></html>