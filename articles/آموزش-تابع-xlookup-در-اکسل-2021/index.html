<!doctype html><html lang="fa" dir="rtl"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="geo.region" content="IRAN"><link rel="canonical" href="https://farsaran.github.io/articles/%D8%A2%D9%85%D9%88%D8%B2%D8%B4-%D8%AA%D8%A7%D8%A8%D8%B9-xlookup-%D8%AF%D8%B1-%D8%A7%DA%A9%D8%B3%D9%84-2021/"><link rel="shortcut icon" href="/favicon.png" type="image/png"><title>آموزش تابع XLOOKUP در اکسل 2021 | فرساران</title><link rel="stylesheet" href="/lib/bootstrap-5.1.3-dist/css/bootstrap.rtl.min.css"><link rel="stylesheet" href="/lib/fontawesome-free-5.15.2-web/css/all.min.css"><link rel="stylesheet" href="/fonts/fonts.css"><link rel="stylesheet" href="/scss/index.eeaf9b5cdc8ca0516d79cf83719363b8d9d044b15ec221f8f8895348d28d009b.css" integrity="sha256-7q+bXNyMoFFtec+DcZNjuNnQRLFewiH4+IlTSNKNAJs=" crossorigin="anonymous"></head><body><nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="farsaran-header-nav"><div class="container"><a class="navbar-brand order-0 flex-grow-1 flex-lg-grow-0" href="/"><img src="/logo.png" alt="فرساران" height="34"></a>
<button class="navbar-toggler order-2 order-lg-1" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="نمایش منو">
<span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse mb-3 mb-lg-0" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"><a class="nav-link" href="/excel/">دوره آموزش اکسل</a></li><li class="nav-item"><a class="nav-link" href="/products/">محصولات</a></li><li class="nav-item"><a class="nav-link" href="/articles/">مقالات آموزشی اکسل</a></li><li class="nav-item"><a class="nav-link" href="https://www.instagram.com/farsaran_excel/">اینستاگرام فرساران</a></li><li class="nav-item"><a class="nav-link" href="/contact/">تماس با ما</a></li></ul><form role="search" action="/search/node" id="navbar-search-form"><input type="search" name="keys" placeholder="جستجو" aria-label="جستجو" class="search-query">
<button type="submit">
<i class="fa fa-search"></i></button></form></div><div id="navbar-accessories" class="d-flex order-1 order-lg-2 mx-3 mx-lg-0"><a href="/contact" class="contact-link"><i class="fa fa-phone"></i></a></div></div></nav><div class="container"><div class="row"><div class="col-12"><header><h1 class="post-title fw-bold fs-2"><a class="text-dark" href="/articles/%D8%A2%D9%85%D9%88%D8%B2%D8%B4-%D8%AA%D8%A7%D8%A8%D8%B9-xlookup-%D8%AF%D8%B1-%D8%A7%DA%A9%D8%B3%D9%84-2021/">آموزش تابع XLOOKUP در اکسل 2021</a></h1></header><article class="blog-post" role="article" typeof="schema:Article"><p class="rtejustify">تابع&nbsp; XLOOKUPیک جایگزین نو و انعطاف پذیر برای توابع قدیمی مثل VLOOKUP و HLOOKUP و LOOKUP&nbsp; است که در نسخه اکسل ۲۰۲۱ اضافه شده است. این تابع برای کشف انطباق های دقیق و تقریبی ، انطباق های جزئی با استفاده از wildcard ها (*؟) و جستجو در محدوده های افقی و عمودی کاربرد دارد . رفته رفته وجوه انعطاف پذیری این تابع را مورد بررسی قرار می دهیم .</p><p class="rtejustify" dir="rtl">به عنوان پیش نیاز ، مقالهء «<a href="/node/26">آموزش تابع VLOOKUP در اکسل- قدم به قدم</a>»&nbsp;را به دوستانی که تازه با توابع اکسل آشنا شده اند پیشنهاد می کنم.</p><h2 class="rtejustify">مزایای تابع XLOOKUP</h2><p class="rtejustify">XLOOKUPدر مقایسه با VLOOKUP چند مزیت مهم دارد که سعی می شود در مثالهائی که می‌آورم این مزایا را نشان دهم :</p><p class="rtejustify">XLOOKUPمی تواند داده ها را در راست یا چپ مقادیر جستجو ، بیابد.</p><p class="rtejustify">XLOOKUPمی تواند چندین نتیجه را برگرداند.</p><p class="rtejustify">پیش فرض XLOOKUPبرای انطباق دقیق است&nbsp; (پیش فرض VLOOKUP مطابقت تقریبی است ).</p><p class="rtejustify">XLOOKUPمی تواند مورد جستجو را&nbsp; در محدوده های عمودی یا افقی رهگیری کند.</p><p class="rtejustify">XLOOKUPاز پس جستجوی معکوس نیز بر می آید (آخرین به اولین).</p><p class="rtejustify">XLOOKUPمی تواند نه فقط یک مقدار&nbsp; بَل کُل سطر یا ستون را برگرداند.</p><p class="rtejustify">XLOOKUPطبعا می تواند با آرایه ها کار کند و شروط پیچیده را اعمال کند.</p><p class="rtejustify">XLOOKUPمی تواند با آرایه های عمودی و افقی کار کند.</p><p class="rtejustify">اگر مقدار جستجو پیدا نشود ، XLOOKUP&nbsp;خطای&nbsp; #N/A &nbsp;را برمی گرداند.</p><p class="rtejustify">آرایه جستجو lookup_array باید دارای ابعادی سازگار با آرگومان return_array باشد، در غیر این صورت XLOOKUP&nbsp;خطای #VALUE را برمی گرداند . بدین معنا که اگر آرایهء جستجو A2:A<span style="color:red">10</span> است&nbsp; return_array نمی تواند مثلاً B2:B<span style="color:red">12</span> &nbsp;&nbsp;باشد</p><p class="rtejustify">اگر از XLOOKUPبین فایل‌های مختلف استفاده می شود ، هر دو فایل&nbsp;باید باز باشد، در غیر این صورت باز گشت خطای REF#&nbsp;از سوی XLOOKUP&nbsp;اجتناب ناپذیر است .</p><p class="rtejustify">آشنایی با ورودی‌های تابع XLOOKUPاکسل</p><p dir="ltr"><span style="font-family:verdana,geneva,sans-serif">&nbsp;=XLOOKUP(lookup_value , lookup_array, return_array, [if_not_found], [match_mode], [search_mode])</span></p><p class="rtejustify" dir="ltr">&nbsp;</p><p class="rtejustify">ورودی اول lookup_value (مقدار جستجو) اگر یک رشته متنی باشد باید بین دو تا علامت (") محصور شود و وقتی به یک سلول اشاره می شود نیازی به این علامت (")نیست . در همین مثال اول به F4 اشاره شده (و نه به کلمه "iran")</p><p class="rtejustify">ورودی دوم lookup_array محدوده ای که واجد مقدار جستجو است</p><p class="rtejustify">ورودی سوم return_array محدوده ای که مقدار متناظر با آرگومان اول انتظار میرود در آن یافت شود ( XLOOKUPبرای احتمال یافت نشدن تمهیدی قائل شده است که ذیلا به آن اشاره خواهد شد ).</p><p class="rtejustify">تا همینجا هم بدون وارد کردن آرگومانهای 4 تا 6 می توان از XLOOKUPسود جست.</p><p class="rtejustify">مثال ۱)</p><p class="rtejustify">می‌خواهیم با وارد کردن «کد پیمان»، نام راننده را پیدا کنیم:</p><p class="rtejustify"><img alt="تابع XLOOKUP در اکسل" height="341" src="https://www.farsaran.com/sites/default/files/field/image/XLOOKUP_1_0.png" width="718"></p><p class="rtejustify" style="direction:rtl">تابع XLOOKUP&nbsp;در سلول G2 نوشته شده است.</p><p class="rtejustify">کد پیمان 3460 در محدودهء C2:C6 موجود است . نام راننده هوشیار متناظر آن در محدوده &nbsp;B2:B6را در سلول G2 بعنوان خروجی ملاحظه می کنید آشکار است که برای XLOOKUP فرقی نمی کند خروجی تابع در سمت چپ یا راست مقدار یا ستون جستجو باشد و این یکی از وجوه انعطاف پذیری XLOOKUPاست .(ناسپاس نیستم زیرا به VLOOKUP و به مایکروسافت و کارکنانش تا همیشه مدیونم).</p><p class="rtejustify">نکته) پیش از این وقتی جستجوی VLOOKUP با شکست مواجه می شد برای کاربر پسند شدن نمای سلول به تابع &nbsp;&nbsp;IFERROR متوسل می شدیم (زیرادر این صورت با خطای #N/A &nbsp;مواجهیم).فرض کنید&nbsp;مایلیم در صورتی که یافت نشد کاربر با عبارت "کد پیمان یافت نشد" روبرو شود. صورت کلی این کار با VLOOKUP چنین درج می شود:</p><p class="rtejustify" style="direction:ltr">=IFERROR( VLOOKUP(&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;), "code peyman yaft nashod!" )</p><p class="rtejustify">ورودی چهارم [if_not_found]&nbsp; این آرگومان اختیاریست ولی وقتی مورد جستجو یافت نشود - بی که منت iferror را بکشد - کاربر می تواند انتظار پیغامی را داشته باشد نه نمایش خطای #N/A</p><p class="rtejustify" style="direction:ltr">=XLOOKUP(F2, C2:C6, B2:B5, "code peyman yaft nashod!")</p><p class="rtejustify">مثال ۲)</p><p class="rtejustify">ورودی پنجم [match_mode] چنانکه&nbsp;از نامش پیداست نوع انطباق با آن مشخص می شود بدین صورت که کاربر یکی از اعداد 1- &nbsp;تا 2 را به امید گرفتن خروجی دلخواه در این ورودی درج می کند . در هر دو مثال مربوط به بارنامه ها بطور پیش فرض آرگومان پنچم 0 (صفر)&nbsp; است . نظر به اینکه شماره بارنامه فقط و فقط به یک راننده و یک شماره پیمان مربوط است بنابر این فرقی نمی کرد که ما 0 را وارد کنیم یا نه . مثال مربوط به تخفیف در جدول زیر به درک بهتری از موضوع کمک می کند .</p><p class="rtejustify">بیائید با هم برای خرید به فروشگاهی سر بزنیم . روی تابلوی اعلانات به جدولی بر می خوریم که مقدار تخفیف را بر اساس میزان خرید(مبالغ به میلیون ریال ) نشان می دهد. آیا مشتریان دقیقا مبالغ موجود در ستون یک را خرید می کنند ؟ مسلماً خیر .حالا فرض می کنیم مسئول فروشگاه فروش هایش را در اکسل ثبت می کند و می‌خواهد بداند هر مشتری با توجه به میزان خرید چند درصد تخفیف شامل حالش می شود.</p><p class="rtejustify"><img alt="ورودی تابع XLOOKUP برای تخفیف و مالیات" height="333" src="https://www.farsaran.com/sites/default/files/field/image/XLOOKUP_NEXT_SMALLER.jpg" width="753"></p><p class="rtejustify">توضیح چند نکته دراینجا خالی از لطف نخواهد بود چون انتظار نداریم در خروجی با خطا مواجه شویم از خیر آرگومان چهارم گذشته ایم (دو علامت "," پشت سر هم بیانگر این در گذشتگی است). هنگام درج آرگومان پنجم در XLOOKUP این پنجرهء کوچک بدرستی خودنمائی می کند تا با توضیحاتش به کمک مان بیاید(خود نمائی مطلقاً و همه جا بد نیست)</p><p class="rtejustify">ملاحظه می کنید که در مقابل کد&nbsp; (1-) عبارت انطباق دقیق یا موردِ کوچکتر و نزدیک به معیار نوشته شده است. بابک&nbsp;را نگاه کنید که 20 میلیون خرید کرده است ، معادلِ دقیقی برای این میزان خرید در جدول پایه تخفیف نداریم پس XLOOKUP فرض می کند مشتری 15میلیون خرید کرده (کوچکتر و نزدیک به ده میلیون) و به او %8&nbsp;تخفیف می دهد.</p><p class="rtejustify">راستی بیائید فرض کنیم روز دوشنبه این هفته جشن تولد پسر صاحب فروشگاه است . وی تصمیم می گیرد یک حال اساسی به مشتریانش بدهد و انطباق دقیق یا مورد بزرگتر و نزدیک به معیار را (در فرمول 1 بجای کد 1- ) جایگزین کند. خوب در این صورت و بر طبق همان جدول، بابک می‌تواند&nbsp;از تخفیف %25 بهره مند شوند (بلا نسبت خواننده مثالش پنبه دانه ایست که به خواب شتر می آید)</p><p class="rtejustify">مثال ۳)</p><p class="rtejustify">&nbsp;در جدول زیر بدنبال ترانه سرائی هستیم که نامش با "Sha" شروع می شود ببینید آیتم چهارم آرگومان پنج چگونه به کمک مان آمده است .</p><p class="rtejustify">&nbsp; &nbsp;<img alt="تابع xlookup اکسل wildcards" height="290" src="https://www.farsaran.com/sites/default/files/field/image/XLOOKUP_wildcards.jpg" width="985"></p><p>&nbsp;</p><div class="farsaran-info">نگارش این مقاله توسط یکی از همراهان قدیمی فرساران که در حوزه اکسل حرفه‌ای کار می‌کنند از روی چندین وب سایت و منبع خارجی انجام شده است. برای ایشان آرزوی تندرستی و شادی داریم.</div><h5>مطالب مرتبط:</h5><ul><li><a href="/articles/%D8%A2%D9%85%D9%88%D8%B2%D8%B4-%D8%AA%D8%A7%D8%A8%D8%B9-vlookup-%D8%AF%D8%B1-%D8%A7%DA%A9%D8%B3%D9%84-%D9%82%D8%AF%D9%85-%D8%A8%D9%87-%D9%82%D8%AF%D9%85/">آموزش تابع VLOOKUP در اکسل - قدم به قدم</a></li><li><a href="/articles/%D9%81%D8%A7%DB%8C%D9%84-%D8%A7%DA%A9%D8%B3%D9%84-%D9%85%D8%AD%D8%A7%D8%B3%D8%A8%D9%87-%D9%85%D8%A7%D9%84%DB%8C%D8%A7%D8%AA-%D8%AD%D9%82%D9%88%D9%82-%D8%B3%D8%A7%D9%84-%DB%B1%DB%B4%DB%B0%DB%B1%D9%88-%D9%87%D9%85%D9%87-%D8%B3%D8%A7%D9%84%D9%87%D8%A7%DB%8C-%D8%A2%DB%8C%D9%86%D8%AF%D9%87/">فایل اکسل محاسبه مالیات حقوق سال ۱۴۰۱و همه سال‌های آینده</a></li></ul></article></div></div></div><footer id="footer-wrapper"><div id="footer-cols-wrapper"><div class="container"><div class="row"><div class="col-md-6 col-lg-3"><p>⭐⭐⭐ دوره‌های آنلاین آموزش اکسل ۱۴۰۱</p><p>استاد دوره: فرشید میدانی</p><p><a href="/excel">دوره آموزش آنلاین اکسل از کاربردی تا پیشرفته</a></p><p><a href="/excel">دوره آموزش آنلاین طراحی داشبورد و نمودارهای خلاقانه در اکسل</a></p><p><a href="/excel">دوره آموزش آنلاین زبان برنامه نویسی VBA در اکسل</a></p></div><div class="col-md-6 col-lg-3"><h5 class="fs-6 fw-bold">محصولات و مقالات</h5><p><a href="/node/106" target="_blank">تاریخ شمسی اکسل و عدد به حروف</a></p><p><a href="/taxonomy/term/126">آموزش اکسل پیشرفته</a></p><p><a href="/node/252" target="_blank">کتاب توابع و فرمول نویسی اکسل</a></p><p><a href="/node/257" target="_blank">کتاب برنامه نویسی VBA اکسل</a></p><p><a href="/pivot" target="_blank">دوره آموزش پیوت تیبل&nbsp;اکسل</a></p></div><div class="col-md-6 col-lg-3"><p><a href="/contact">تماس با ما</a></p><p><a href="/فرشید-میدانی">مشاهده رزومه فرشید میدانی&nbsp;</a></p><p><a href="/node/114">راهنمای خرید از فروشگاه</a></p><p><a href="/node/114#guaranty">شرایط گارانتی و پشتیبانی محصولات</a></p><p><a href="/node/114#guaranty">درخواست عودت وجه محصولات</a></p><p><a href="http://t.me/farsaran" rel="nofollow">کانال تلگرام اکسل فرساران</a></p></div><div class="col-md-6 col-lg-3"><p>مقالات آموزشی اکسل</p><p>⭐&nbsp;<a href="/farfand">فرفند، کاربردی ترین ترفند اکسل</a></p><p><a href="/node/294">محاسبه مالیات حقوق در اکسل</a></p><p><a href="/vlookup">آموزش تابع VLOOKUP در اکسل</a></p><p><a href="/sumifs">آموزش تابع SUMIFS در اکسل</a></p></div></div></div></div><div id="footer-bottom-wrapper"><div class="container"><div class="row"><div class="col-12"><p><span style="font-size:16px">&nbsp;فرساران | تجربه حرفه‌ای و تمام وقت<a href="/node/313"><span style="color:#fff"> <u>آموزش اکسل</u></span></a><span style="color:#fff"> </span>از سال ۱۳۸۵ در صدها شرکت و سازمان تراز اول ایران</span></p><p><strong><u><a href="https://fa.wikipedia.org/wiki/%D8%AF%D8%B3%D8%AA%D8%A8%D8%B1%D8%AF_%D9%81%DA%A9%D8%B1%DB%8C" target="_blank"><span style="color:#fff">دستبرد علمی</span></a></u></strong><span style="color:#fff"> </span>یعنی تخصیص دادن خلاقیت ادبی، هنری یا پژوهشی دیگری یا بخشی از آن یا متن ناشی از آن به خود، گویی که خود شخص آن را خلق کرده‌است.&nbsp;</p></div></div></div></div></footer><script src="/lib/jQuery/jquery-3.6.0.min.js"></script>
<script src="/lib/bootstrap-5.1.3-dist/js/bootstrap.bundle.min.js"></script></body></html>