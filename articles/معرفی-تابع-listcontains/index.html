<!doctype html><html lang="fa" dir="rtl"><head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="geo.region" content="IRAN"><link rel="canonical" href="https://farsaran.github.io/articles/%D9%85%D8%B9%D8%B1%D9%81%DB%8C-%D8%AA%D8%A7%D8%A8%D8%B9-listcontains/"><link rel="shortcut icon" href="/favicon.png" type="image/png"><title>معرفی تابع List.Contains | فرساران</title><link rel="stylesheet" href="/lib/bootstrap-5.1.3-dist/css/bootstrap.rtl.min.css"><link rel="stylesheet" href="/lib/fontawesome-free-5.15.2-web/css/all.min.css"><link rel="stylesheet" href="/fonts/fonts.css"><link rel="stylesheet" href="/scss/index.eeaf9b5cdc8ca0516d79cf83719363b8d9d044b15ec221f8f8895348d28d009b.css" integrity="sha256-7q+bXNyMoFFtec+DcZNjuNnQRLFewiH4+IlTSNKNAJs=" crossorigin="anonymous"></head><body><nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="farsaran-header-nav"><div class="container"><a class="navbar-brand order-0 flex-grow-1 flex-lg-grow-0" href="/"><img src="/logo.png" alt="فرساران" height="34"></a>
<button class="navbar-toggler order-2 order-lg-1" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="نمایش منو">
<span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse mb-3 mb-lg-0" id="navbarSupportedContent"><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item"><a class="nav-link" href="/excel/">دوره آموزش اکسل</a></li><li class="nav-item"><a class="nav-link" href="/products/">محصولات</a></li><li class="nav-item"><a class="nav-link" href="/articles/">مقالات آموزشی اکسل</a></li><li class="nav-item"><a class="nav-link" href="https://www.instagram.com/farsaran_excel/">اینستاگرام فرساران</a></li><li class="nav-item"><a class="nav-link" href="/contact/">تماس با ما</a></li></ul><form role="search" action="/search/node" id="navbar-search-form"><input type="search" name="keys" placeholder="جستجو" aria-label="جستجو" class="search-query">
<button type="submit">
<i class="fa fa-search"></i></button></form></div><div id="navbar-accessories" class="d-flex order-1 order-lg-2 mx-3 mx-lg-0"><a href="/contact" class="contact-link"><i class="fa fa-phone"></i></a></div></div></nav><div class="container"><div class="row"><div class="col-12"><header><h1 class="post-title fw-bold fs-2"><a class="text-dark" href="/articles/%D9%85%D8%B9%D8%B1%D9%81%DB%8C-%D8%AA%D8%A7%D8%A8%D8%B9-listcontains/">معرفی تابع List.Contains</a></h1></header><article class="blog-post" role="article" typeof="schema:Article"><p class="rtecenter"><span dir="rtl">تعالی الله یکی بی مثل و مانند</span></p><p align="center"><span dir="rtl">که خوانندش خداوندان "خداوند"</span></p><p align="center" dir="rtl">&nbsp;</p><p dir="rtl">مقدمه 1</p><p class="rtejustify" dir="rtl">از جمله توابع زیر مجموعه <span dir="ltr">List</span> یکی همین <span dir="ltr">List.Contains</span> و دو تا از اعوان و انصارش است . همین شش مثال را که از سایت مایکروسافت آوردم برای آشنائی اولیه کفایت می کند . در خصوص <span dir="ltr">List.Contains</span> می بینید که پارامتر اولش یک لیست است و پارامتر دوم چیزی از جنس همان اعضاء لیست اول ،ولی نه یک لیست . اما در مورد دو تابع بعدی هر دو پارامتر لیست هستند . یافتن فرق توابع از روی مثال ها آسان است</p><p dir="ltr">List.Contains ( { 1 , 2 ,3 , 4 , 5 ,6 } , 4 ) →true</p><p dir="ltr">List.Contains ( { <span dir="rtl">"َ</span>A<span dir="rtl">"</span> , "B" , "C" , "D"&nbsp; } , "F" ) →false</p><p dir="ltr">List.ContainsAll ( { 1 , 2 ,3 , 4 , 5 ,6 } , { 4 , 6 } ) →true</p><p dir="ltr">List.ContainsAll ( { 1 , 2 ,3 , 4 , 5 ,6 } , { 4 , 7 } ) →false</p><p dir="ltr">List.ContainsAny ( { 1 , 2 ,3 , 4 , 5 ,6 } , { 4 , 7 } ) →true</p><p dir="ltr">List.ContainsAll ( { 1 , 2 ,3 , 4 , 5 ,6 } , { 0 , 7 } ) →false</p><p dir="rtl">مقدمه 2</p><p dir="rtl">پیش از ورود به بحث اصلی فرض کنید در پاور کوئری ستونی از اعداد داریم و می خواهیم حاصلضرب ستون اول را در دو ضرب و در یک ستون جدید جایگزین کنیم . برای این کار عبارت زیر را در یک <span dir="ltr">Custom Column</span> می نویسیم</p><p dir="ltr">[Column1]*2</p><p class="rtejustify" dir="rtl">یعنی آقای پاور کوئری لطفا هر <strong>سلول</strong> را از ستونی بنام <span dir="ltr">[Column1]</span> در دو ضرب کن و حاصلضرب را در ستون جدید درج کن . اینکار – درست یا غلط - مرا یاد حلقه <span dir="ltr">FOR</span> در <span dir="ltr">VBA </span>&nbsp;می اندازد . انگار در هر لحظه <strong>یک سلول</strong> از ستون <span dir="ltr">Column1</span> بجای <span dir="ltr">[Column1]</span> نشسته باشد و در دو ضرب شود و حاصل در سلول متناظرش در ستون دوم بنشیند. &nbsp;</p><p class="rtejustify" dir="rtl">بحث اصلی</p><p class="rtejustify" dir="rtl">حالا فرض کنید ستونی از حروف داریم قرار است یک ستون <span dir="ltr">Custom</span> درست کنیم . به این شرط که اگر هر سلول در ستون اول یکی از حروف <span dir="ltr">A </span>&nbsp;یا&nbsp; <span dir="ltr">F</span> یا&nbsp; <span dir="ltr">I</span> یا <span dir="ltr">S</span> &nbsp;بود پاور کوئری برایمان در ستون <span dir="ltr">Custom </span>&nbsp;، <span dir="ltr">Yes </span>&nbsp;را و در غیر اینصورت <span dir="ltr">No</span> را درج کند .</p><p class="rtejustify" dir="rtl"><img alt height="718" src width="800"></p><p class="rtejustify" dir="rtl">&nbsp;</p><p dir="rtl">راه اول</p><p dir="rtl">یک راه ساده اینست که اولا جدول تک ستونی آبی رنگ را به محیط پاور کوئری منتقل کنیم و سپس یک ستونی <span dir="ltr">Custom</span> ی <span dir="ltr">Add</span> کنیم و کد زیر را در آن بنویسیم . فقط برای خواناتر شدن چنین نوشتم وگرنه .....</p><p dir="ltr">If</p><p dir="ltr">&nbsp;&nbsp;&nbsp; [Category]="A" or [Category]="F" or [Category]="I" or [Category]="S"</p><p dir="ltr">&nbsp;&nbsp;&nbsp; Then</p><p dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"yes"</p><p dir="ltr">&nbsp;&nbsp; &nbsp;else</p><p dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "no"</p><p><img alt height="542" src width="800"></p><p>&nbsp;</p><p dir="rtl">جدول سبز رنگ شکل یک حاصل استفاده از ساده ترین زبان برای رسیدن به مقصود است (اگر کوئری را در اکسل بارگذاری کنیم )</p><p dir="rtl">راه دوم</p><p dir="rtl">از تابعی که در مقدمه معرفی شد کمک بگیریم و این بار در پنجرهء <span dir="ltr">Custom Column</span> کد زیر را بنویسیم</p><p dir="ltr">if List.Contains(&nbsp; {"A" , "F" , "I" , "S" } , [Category] ) = true</p><p dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;then</p><p dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Yes"</p><p dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</p><p dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "No"</p><p class="rtejustify" dir="rtl">پارامتر اول تابع&nbsp; ، چنانکه انتظار می رفت لیستی است با چهار عضو . حالا مقدمهء دوم را بخاطر آورید در هر لحظه یکی از سلولهای ستون &nbsp;<span dir="ltr">Category</span>بجای&nbsp; <span dir="ltr">[Category]</span> می نشیند و تابع چک می کند آیا محتویات سلول برابر یکی از اعضاء لیست اول هست یا نه ؟ اگر نتیجه <span dir="ltr">true </span>&nbsp;بود که متناظرآن سلول در ستون دوم <span dir="ltr">Yes</span> و در غیر اینصورت <span dir="ltr">No</span> را می نشاند .</p><p class="rtejustify" dir="rtl">&nbsp;</p><p class="rtejustify" dir="rtl"><img alt height="496" src width="800"></p><p class="rtejustify" dir="rtl">&nbsp;</p><p class="rtejustify" dir="rtl">سوال : آیا همیشه لیست موجود در پارامتر اول چهار یا پنج تا حرف است یا ممکن است چهل عضو داشته باشد ؟ سوال : آیا بهتر نبود کاربر این اختیار را داشت که هم خود اعضاء لیست و هم تعداد شان را تغییر دهد&nbsp; و به اصطلاح اعضای لیست کاملاً داینامیک باشند ؟ . تصور امکان استفاده از دو روش بالا با فرض داینامیک بودن ِ لیستِ اول محال نیست ؟</p><p dir="rtl">مسلما در مثالهای واقعی به این سادگی نیست .</p><p dir="rtl">&nbsp;</p><p dir="rtl">راه سوم</p><p dir="rtl">لیست پارامتر اول تابع <span dir="ltr">List.Contains</span>&nbsp; را در یک <span dir="ltr">Table </span>&nbsp;داخل اکسل سامان دادم . ببینید تا صدق گفتارم را دریابید (شیت دوم فایل ضمیمه)</p><p dir="rtl">&nbsp;</p><p dir="rtl"><img alt height="357" src width="600"></p><p dir="rtl">&nbsp;</p><p dir="rtl">این <span dir="ltr">Table</span> را به ادیتور پاور کوئری منتقل کردم . آن را چنان که می دانید و می بینید به یک لیست تغییر دادم . حالا نامش <span dir="ltr">OuerList</span> است . کد زیر را در پنجرهء <span dir="ltr">Custom Column</span> مرقوم بفرمائید . یک کد شُسته رُفته و ُ کارا .</p><p dir="ltr">&nbsp;if List.Contains(&nbsp; OuerList , [Category] ) = true</p><p dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;then</p><p dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Yes"</p><p dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else</p><p dir="ltr">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"No</p><p class="rtejustify" dir="rtl">محکم بنشینید و در صفحه اکسل (شیت دو&nbsp; ِ فایل پیوست) یک حرف به جدول <span dir="ltr">MyList</span> اضافه کنید سپس روی جدول سبز رنگ که خروجی کوئری <span dir="ltr">professional</span> است کلیک راست کرده دکمه <span dir="ltr">Refresh</span> را محترمانه بفشارید .</p><p class="rtejustify" dir="rtl">شما را با حس ذوق زدگی رها نمی کنم برایتان یک سورپرایز دیگر دارم . آن را بهمراه کوئریهای مربوط به این مقاله در فایل ضمیمه ببینید .</p><p dir="rtl">ندیده های گرامی! شما را به خدا می سپارم .</p><h5>فایل های ضمیمه</h5><ul><li><a href="/articles/%D9%85%D8%B9%D8%B1%D9%81%DB%8C-%D8%AA%D8%A7%D8%A8%D8%B9-listcontains/attached/Table.Select.xlsx">attached/Table.Select.xlsx</a></li></ul><h5>مطالب مرتبط:</h5><ul><li><a href="/articles/%D8%AF%D8%B4%D8%A8%D9%88%D8%B1%D8%AF-%D9%88-%D9%87%D9%88%D8%B4-%D8%AA%D8%AC%D8%A7%D8%B1%DB%8C-%D8%A7%DA%A9%D8%B3%D9%84/">دشبورد و هوش تجاری اکسل</a></li><li><a href="/articles/power-query-%D9%BE%D8%A7%D9%88%D8%B1-%DA%A9%D9%88%D8%A6%D8%B1%DB%8C-%DA%86%DB%8C%D8%B3%D8%AA%D8%9F/">POWER QUERY (پاور کوئری) چیست؟</a></li><li><a href="/articles/%D9%85%D9%81%D8%A7%D9%87%DB%8C%D9%85-%D9%88-%DA%A9%D8%A7%D8%B1-%D8%A8%D8%A7-%D9%84%DB%8C%D8%B3%D8%AA%E2%80%8C%D9%87%D8%A7-%D8%AF%D8%B1-%D9%BE%D8%A7%D9%88%D8%B1%DA%A9%D9%88%D8%A6%D8%B1%DB%8C-%D8%A7%DA%A9%D8%B3%D9%84-%D8%AA%D8%A8%D8%AF%DB%8C%D9%84-%DB%8C%DA%A9-%D8%B3%D8%AA%D9%88%D9%86-%D8%A8%D9%87-%D8%AC%D8%AF%D9%88%D9%84/">مفاهیم و کار با لیست‌ها در پاورکوئری اکسل - تبدیل یک ستون به جدول</a></li></ul></article></div></div></div><footer id="footer-wrapper"><div id="footer-cols-wrapper"><div class="container"><div class="row"><div class="col-md-6 col-lg-3"><p>⭐⭐⭐ دوره‌های آنلاین آموزش اکسل ۱۴۰۱</p><p>استاد دوره: فرشید میدانی</p><p><a href="/excel">دوره آموزش آنلاین اکسل از کاربردی تا پیشرفته</a></p><p><a href="/excel">دوره آموزش آنلاین طراحی داشبورد و نمودارهای خلاقانه در اکسل</a></p><p><a href="/excel">دوره آموزش آنلاین زبان برنامه نویسی VBA در اکسل</a></p></div><div class="col-md-6 col-lg-3"><h5 class="fs-6 fw-bold">محصولات و مقالات</h5><p><a href="/node/106" target="_blank">تاریخ شمسی اکسل و عدد به حروف</a></p><p><a href="/taxonomy/term/126">آموزش اکسل پیشرفته</a></p><p><a href="/node/252" target="_blank">کتاب توابع و فرمول نویسی اکسل</a></p><p><a href="/node/257" target="_blank">کتاب برنامه نویسی VBA اکسل</a></p><p><a href="/pivot" target="_blank">دوره آموزش پیوت تیبل&nbsp;اکسل</a></p></div><div class="col-md-6 col-lg-3"><p><a href="/contact">تماس با ما</a></p><p><a href="/فرشید-میدانی">مشاهده رزومه فرشید میدانی&nbsp;</a></p><p><a href="/node/114">راهنمای خرید از فروشگاه</a></p><p><a href="/node/114#guaranty">شرایط گارانتی و پشتیبانی محصولات</a></p><p><a href="/node/114#guaranty">درخواست عودت وجه محصولات</a></p><p><a href="http://t.me/farsaran" rel="nofollow">کانال تلگرام اکسل فرساران</a></p></div><div class="col-md-6 col-lg-3"><p>مقالات آموزشی اکسل</p><p>⭐&nbsp;<a href="/farfand">فرفند، کاربردی ترین ترفند اکسل</a></p><p><a href="/node/294">محاسبه مالیات حقوق در اکسل</a></p><p><a href="/vlookup">آموزش تابع VLOOKUP در اکسل</a></p><p><a href="/sumifs">آموزش تابع SUMIFS در اکسل</a></p></div></div></div></div><div id="footer-bottom-wrapper"><div class="container"><div class="row"><div class="col-12"><p><span style="font-size:16px">&nbsp;فرساران | تجربه حرفه‌ای و تمام وقت<a href="/node/313"><span style="color:#fff"> <u>آموزش اکسل</u></span></a><span style="color:#fff"> </span>از سال ۱۳۸۵ در صدها شرکت و سازمان تراز اول ایران</span></p><p><strong><u><a href="https://fa.wikipedia.org/wiki/%D8%AF%D8%B3%D8%AA%D8%A8%D8%B1%D8%AF_%D9%81%DA%A9%D8%B1%DB%8C" target="_blank"><span style="color:#fff">دستبرد علمی</span></a></u></strong><span style="color:#fff"> </span>یعنی تخصیص دادن خلاقیت ادبی، هنری یا پژوهشی دیگری یا بخشی از آن یا متن ناشی از آن به خود، گویی که خود شخص آن را خلق کرده‌است.&nbsp;</p></div></div></div></div></footer><script src="/lib/jQuery/jquery-3.6.0.min.js"></script>
<script src="/lib/bootstrap-5.1.3-dist/js/bootstrap.bundle.min.js"></script></body></html>